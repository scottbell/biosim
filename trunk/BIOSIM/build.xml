<project name="BioSim" default="all" basedir=".">
	<description>
        	Build file for BioSim
	</description>
	<!-- set global properties for this build -->
  	<property name="src" location="src"/>
	<property name="generated" location="generated"/>
	<property name="classes" location="${generated}/classes"/>
	<property name="server" location="${generated}/server"/>
	<property name="serverClasses" location="${server}/classes"/>
	<property name="serverStubs" location="${server}/stubs"/>
	<property name="lib" location="lib"/>
	<property name="jacorbDir" location="${lib}/jacorb"/>
	<property name="xercesDir" location="${lib}/xerces"/>

	<target name="init">
		<mkdir dir="${generated}"/>
	</target>
  
  	<target name="stubServer" depends="init" description="stub the IDL file" >
		<mkdir dir="${serverStubs}"/>
		<java classname="ParserHack">
			<arg value="-d"/> 
			<arg file="${serverStubs}"/>
			<arg file="${src}/biosim/idl/biosim.idl"/>
			<classpath>
				<pathelement location="${jacorbDir}"/>
				<pathelement location="${jacorbDir}/idl.jar"/>
				<pathelement location="${jacorbDir}/logkit.jar"/>
			</classpath>
		</java>
		<mkdir dir="${serverClasses}"/>
		<javac srcdir="${serverStubs}" destdir="${serverClasses}" compiler="jikes">
			<classpath>
				<pathelement location="${jacorbDir}/jacorb.jar"/>
			</classpath>
		</javac>
	</target>

	<target name="server" depends="stubServer" description="compile the server" >
		<mkdir dir="${server}"/>
		<mkdir dir="${serverClasses}"/>
		<javac srcdir="${src}" destdir="${generated}" compiler="jikes">
			<classpath>
				<pathelement location="${serverClasses}"/>
				<pathelement location="${jacorbDir}/jacorb.jar"/>
				<pathelement location="${xercesDir}/xercesImpl.jar"/>
				<pathelement location="${xercesDir}/xml-apis.jar"/>
				<pathelement location="${xercesDir}/xmlParserAPIs.jar"/>
			</classpath>
		</javac>
	</target>
  
   	<target name="client" description="compile the client" >
	</target>
  
  	<target name="all" depends="server,client" description="compile biosim" >
	</target>

	<target name="clean" description="clean up" >
		<delete dir="${generated}"/>
	</target>
</project>
